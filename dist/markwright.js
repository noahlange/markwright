!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.markwright=t():e.markwright=t()}(window,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("simple-markdown")},function(e,t){e.exports=require("react-virtualized")},function(e,t){e.exports=require("react-promise")},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(2),c=n(1);class i{constructor(){this.elements=[]}get size(){return this.elements.length}get height(){const e=e=>e?parseInt(e,10):0;let[t,n]=[0,0];for(const o of this.elements){const{height:r}=o.getBoundingClientRect(),c=getComputedStyle(o),i={bottom:e(c.marginBottom),top:e(c.marginTop)};t+=r+Math.max(n,i.top),n=i.bottom}return t}add(e){this.elements.push(e)}}class s{constructor(){this.regions=[]}add(e){this.regions.push(e)}}function a(e,t,n,o={type:"text",content:""}){return{content:[{content:o,id:`mw-page-${e}-header`,type:"mw-header"},{content:[{content:t,id:`mw-page-${e}-content`,type:"mw-content"},{content:n.map(e=>Object.assign({},e,{inline:!1})),id:`mw-page-${e}-footnotes`,type:"mw-footnotes"}],id:`mw-page-${e}-body`,type:"mw-body"}],id:e,type:"mw-page"}}function l(e,t=[],n=2){let o=[];for(const t of e){let e=o[o.length-1];"heading"===t.type&&1===t.level&&(e&&e.title||!e?(o.push({content:[],id:o.length+1,title:t.content,type:"mw-section"}),e=o[o.length-1]):e&&(e.title=t.content)),e?e.content.push(t):o.push({content:[t],id:1,type:"mw-section"})}if(t.length){let e=1;o=o.map((o,r)=>{const c=[],i=[];let s=0;for(const e of t[r].regions){const t=[];for(const n of e.elements){let e=!1;for(;!e;){const n=o.content[s];if(n){if(t.push(n),s++,"newline"===n.type)continue;e=!0}else e=!0}}i.push(t)}for(;i.length;){const e=[];for(let t=0;t<n;t++)e.push(i.shift());c.push(e)}return o.content=c.map((t,n)=>{const r=[];let c=1;n++,function e(t,n){if(t){if(Array.isArray(t))for(const o of t)e(o,n);if(n(t),t.content)for(const o of t.content)e(o,n)}}(t,e=>{"mw-footnote"===e.type&&(e.key=`mw-page-${n}-footnote-${c++}`,r.push(Object.assign({},e)),e.inline=!0)});const i=t.filter(e=>!!e).map((e,t)=>function(e,t){return{content:t,id:e,type:"mw-column"}}(`mw-page-${n}-column-${t+1}`,e)).reduce((e,t,o)=>0===o?[t]:[...e,{id:`mw-page-${n}-column-separator-${o}`,type:"mw-column-separator"},t],[]);return a(e++,i,r,o.title)}),o})}else{let e=0;o=o.map(t=>(e++,t.content=[a(e,{content:t.content,id:`mw-page-${e}-column-1`,type:"mw-column"},[],t.title)],t))}return o}var u=n(3),d=n.n(u);function m(e,t="div"){return{react:(n,r,c)=>o.createElement(t,{children:r(n.content),className:e.replace("mw-",""),key:n.id||c.key})}}function p(e,t,n){const r=Object(c.ruleOutput)(n,"react"),i=Object(c.reactFor)(r);return({key:n,index:r,style:c})=>{let s=0;const a=t.find(e=>(s+=e.content.length)>r),l=a.content[r-s+a.content.length];return o.createElement("div",{key:n,style:Object.assign({},c,{left:(window.innerWidth-e.width)/2,marginBottom:32,top:c.top+64})},i(l))}}class f extends o.Component{constructor(){super(...arguments),this.state={content:this.props.value,flowed:!1,regions:[],style:"\n      .unflowed .footnote { display: block; }\n    "}}static react(e,t,n,i,s){const a=this.rules?this.rules:this.rules=(({highlight:e})=>Object.assign({},c.defaultRules,{blockQuote:Object.assign({},c.defaultRules.blockQuote,{match:Object(c.blockRegex)(/^( *>[^\n]+(\n[^\n]+)*\n*)+\n/)}),codeBlock:Object.assign({},c.defaultRules.codeBlock,{react(t,n,r){const c=e?e(t.content,t.lang):Promise.resolve(t.content);return o.createElement("div",{key:r.key},o.createElement(d.a,{promise:c,pending:()=>o.createElement("pre",null,o.createElement("code",null,t.content)),then:e=>o.createElement("pre",{className:"lang lang-"+t.lang},o.createElement("code",{dangerouslySetInnerHTML:{__html:e}}))}))}}),heading:Object.assign({},c.defaultRules.heading,{match:Object(c.blockRegex)(/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n *)/)}),mw:{react:(e,t)=>o.createElement("div",{className:"mw",key:"mw-"+e.id},t(e.content))},"mw-block":{match:Object(c.blockRegex)(/^ *(:{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n *)+\n/),order:0,parse:(e,t,n)=>(n.blocks||(n.blocks=1),{block:e[2],content:t(`\n\n${e[3]}\n\n`,{inline:!1},n),id:n.blocks++}),react:(e,t)=>o.createElement("div",{key:e.id,className:"block "+e.block},t(e.content))},"mw-body":m("mw-body"),"mw-break":{match:Object(c.blockRegex)(/^\{\.break\}/),order:0,parse:(e,t,n)=>(n.breaks||(n.breaks=1),{id:n.breaks++}),react:e=>o.createElement("div",{key:"mw-break-"+e.id,className:"break"})},"mw-column":m("mw-column"),"mw-column-separator":{react:e=>o.createElement("hr",{key:e.id,className:"column-separator"})},"mw-content":m("mw-content"),"mw-footnote":{match:Object(c.inlineRegex)(/^\^\[(.+?)\]/),order:c.defaultRules.link.order-1,parse:(e,t,n)=>(n.footnotes||(n.footnotes=1),{content:t(e[1],n),id:n.footnotes++}),react:(e,t)=>e.inline?o.createElement("sup",{key:e.id+"-inline"},e.id):o.createElement("span",{key:e.id,className:"footnote"},e.id,". ",t(e.content))},"mw-footnotes":{react(e,t){const n="footnotes "+(e.content&&e.content.length?"":"empty");return o.createElement("div",{key:"mw-footnote-"+e.id,className:n},t(e.content))}},"mw-header":m("mw-header"),"mw-page":{react(e,t){const n=e.id%2?"odd":"even";return o.createElement("div",{key:"mw-page-"+e.id,className:`page page-${e.id} ${n}`},o.createElement(o.Fragment,null,t(e.content),o.createElement("div",{key:`mw-page-${e.id}-pagination`,className:"pagination"},e.id)))}},"mw-section":{react:(e,t)=>o.createElement("div",{key:"mw-section-"+e.id,className:"section section-"+e.id},t(e.content))},paragraph:Object.assign({},c.defaultRules.paragraph,{react:(e,t,n)=>o.createElement("p",{key:"p-"+n.key},t(e.content))})}))({highlight:i}),u=l(Object(c.parserFor)(a)(e),t,n),f=u.reduce((e,t)=>e+t.content.length,0)||1,h=this.ref?this.ref.clientWidth:window.innerWidth,g=this.ref?this.ref.clientHeight:window.innerHeight;return o.createElement("div",{className:"section"},o.createElement(r.List,{width:h,height:g,rowHeight:s.height+64,rowCount:f,rowRenderer:p(s,u,a)}))}static getDerivedStateFromProps(e,t){return e.value!==t.content?{content:e.value,flowed:!1,regions:[]}:e.flowed?{flowed:!0,regions:e.regions}:null}static flow(e){const t=[];for(const n of this.ref.querySelectorAll(".page")){const o=new s,r=n.querySelector(".column");if(r){const n=r.getBoundingClientRect().height-48,c=[].slice.call(r.children);let s=new i;for(const t of c)t.classList.contains("break")?(o.add(s),s=new i,s.add(t)):(s.add(t),!e&&s.height>n&&(s.elements.pop(),o.add(s),s=new i,s.add(t)));o.add(s),t.push(o)}}return t}reflow(){this.state.flowed||this.props.onFlow(f.flow(this.props.manual))}componentDidUpdate(){this.reflow()}componentDidMount(){this.reflow()}render(){return o.createElement("div",{className:this.state.flowed?"":"unflowed",ref:e=>f.ref=e},o.createElement("style",{type:"text/css"},this.state.style),f.react(this.state.content||" ",this.state.regions,this.props.columns,this.props.highlight,this.props.page))}}t.default=class extends o.Component{constructor(){super(...arguments),this.state={flowed:!1,regions:[]}}config(e,t){return this.props.config?null!=this.props.config[e]?this.props.config[e]:t:t}render(){return o.createElement(f,{value:this.props.value,page:this.config("page",{width:816,height:1056}),manual:this.config("manual",!1),columns:this.config("manual",!1)?1:this.config("columns",2),highlight:this.config("highlight"),flowed:this.state.flowed,regions:this.state.regions,onFlow:e=>this.setState({flowed:!0,regions:e})})}}}])}));